Add-PSSnapin VMware.VimAutomation.Core
. 'C:/Program Files (x86)/VMware/Infrastructure/vSphere PowerCLI/Scripts/Initialize-PowerCLIEnvironment.ps1'

###### Initilization done ######

# ENTER vCenter IP address or FQDN:
$vCenterAddress = "x.x.x.x"

# ENTER vCenter Username here:
$vCenterUser = "example_vcenter_username"

# ENTER vCenter Password here:
$vPassword = "example_vcenter_password"

# ENTER VM prefix name:
$VMprefix = "example_vm_prefix"

# ENTER the guest operating system username for all of the selected VMs:
$gUsername = "example_guestOS_username"

# ENTER the guest operating system password for all of the selected VMs, given username:
$gPassword = "example_guestOS_password"

# ENTER the source path of the file to copy:
$source = "C:\Example_source_file_path"

# ENTER the destination path of the file to copy to the VM guest OS:
$destination = "/Example_destination_file_path"


###### End of user input ######

#Connecting to vCenter...
Connect-VIServer $vCenterAddress -User $vCenterUser -Password $vPassword -WarningAction SilentlyContinue

$VMsearch = $VMprefix + "*"
$vms = Get-VM -Name $VMsearch

foreach($vm in $vms) {

    Copy-VMGuestFile -Source $source -Destination $destination -VM $vm -LocalToGuest -GuestUser $gUsername -GuestPassword $gPassword -Force

}
